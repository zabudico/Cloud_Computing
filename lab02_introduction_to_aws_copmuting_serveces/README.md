# Лабораторная работа №2. Введение в AWS. Вычислительные сервисы

## Постановка задачи

Лабораторная работа направлена на знакомство с основными вычислительными сервисами Amazon Web Services (AWS), включая создание и настройку виртуальных машин EC2, управление доступом через IAM, настройку мониторинга и развертывание веб-приложений.


### Цель и основные этапы работы

Освоить основы работы с облачной инфраструктурой AWS, научиться создавать и управлять виртуальными машинами, настраивать безопасность и мониторинг.

### Основные этапы:

0. Подготовка среды
1. Создание IAM пользователей и групп
2. Настройка бюджета для контроля расходов
3. Запуск и конфигурация EC2 инстансов
4. Настройка веб-сервера nginx
5. Мониторинг и логирование
6. Подключение по SSH
7. Развертывание Docker-приложения

Условие
Задание 0. Подготовка среды
Зарегистрируйтесь в AWS и создайте бесплатный аккаунт (Free Tier).
Перейдите по ссылке: https://aws.amazon.com/
Нажмите "Create an AWS Account" и следуйте инструкциям.
Подробный процесс показан в теоретическом материале 02_AWS_Introduction
Войдите в консоль управления под root-пользователем.
В правом верхнем углу выберите регион EU (Frankfurt) eu-central-1.
Задание 1. Создание IAM группы и пользователя
IAM — это сервис для управления доступом в AWS. Здесь создаются пользователи, группы и политики (наборы прав).

Откройте сервис IAM (Identity and Access Management).
Создайте IAM группу Admins:

Перейдите в раздел "Groups" и нажмите "Create New Group".
Введите имя группы Admins и нажмите "Next Step".
На шаге "Attach Policy" выберите политику AdministratorAccess.
Что делает данная политика?
///////////////////////////


3. Создал IAM пользователя с любым именем:
    * Перешёл в раздел "Users" и нажал "Add user".
    * Ввёл имя пользователя `admin`.
    * Привязал пользователя к группе `Admins`.
    Разрешил пользователю доступ в AWS Management Console.
4. Убедился, что пользователь создан и имеет доступ к консоли.

5. Выйдите из консоли под root-пользователем и войдите под новым IAM пользователем.


#### Задание 2. Настройка Zero-Spend Budget
Открыл сервис Billing and Cost Management.
В меню слева выбрал Budgets → Create budget.
выбрал "Zero spend budget" шаблон и укажите следующие параметры:
Budget name: ZeroSpend
Email recipients: ваш email
нажал "Create budget" внизу страницы.
После создания данного бюджета вы будете получать уведомления, если ваши расходы превысят $0.

Задание 3. Создание и запуск EC2 экземпляра (виртуальной машины)
Для запуска и настройки виртуальной машины используется сервис Amazon EC2 (Elastic Compute Cloud).

Открыл сервис EC2.
В меню слева выбрал Instances → Launch instances.
Заполните соответствующие параметры для запуска виртуальной машины:

Name and tags: webserver.
AMI: выбрал Amazon Linux 2023 AMI. Это образ, который будет использоваться для создания виртуальной машины.
Instance type: t3.micro.
Key pair. Это криптографическая пара ключей (приватный и публичный). Она нужна для безопасного входа на сервер по SSH.
выбрал "Create a new key pair".
Ввёл имя для ключа в формате yournickname-keypair.
нажал "Create key pair" и скачайте файл с приватным ключом (расширение .pem). Сохраните его в надежном месте.
Security group. Это набор правил, которые определяют, какой трафик разрешен к вашему экземпляру.

выбрал "Create a new security group".
Ввёл имя группы webserver-sg.
Добавьте два правила для входящего трафика (Inbound rules).
Разрешить входящий HTTP трафик с любого IP-адреса.
Разрешить входящий SSH трафик только с вашего текущего IP-адреса.
Network settings. Оставьте настройки по умолчанию. AWS автоматически создаст виртуальную сеть (VPC) и подсеть (subnet).

Configure Storage. Оставьте настройки по умолчанию.

Пролистайте вниз до Advanced details → User Data и вставьте следующий скрипт:

#!/bin/bash
dnf -y update
dnf -y install htop
dnf -y install nginx
systemctl enable nginx
systemctl start nginx
В зависимости от выбранного AMI, команды в скрипте могут отличаться.

Что такое User Data и какую роль выполняет данный скрипт? Для чего используется nginx?

нажал Launch instance и дождитесь статуса Running и Status checks: 2/2. После того, как виртуальная машина запустится, вы увидите её публичный IP-адрес в колонке "IPv4 Public IP".

Проверьте, что веб-сервер работает, открыв в браузере URL: http://<Public-IP>, где <Public-IP> — это публичный IP-адрес вашей виртуальной машины.
Задание 4. Логирование и мониторинг
Мониторинг — это важная часть обеспечения надёжности, доступности и производительности ваших экземпляров Amazon EC2 и решений в AWS.

Открыл вкладку Status checks.
В карточке вашего инстанса EC2 найдите вкладку Status checks.
Здесь вы можете быстро определить, выявил ли Amazon EC2 какие-либо проблемы, которые могут помешать работе приложений.
Amazon EC2 выполняет автоматические проверки для каждого работающего экземпляра:
System reachability check — проверяет инфраструктуру AWS (железо и гипервизор).
Instance reachability check — проверяет, доступна ли операционная система на уровне инстанса.
Убедился, что обе проверки прошли успешно (2/2 checks passed).
Открыл вкладку Monitoring.
На этой вкладке отображаются метрики Amazon CloudWatch для вашего инстанса.
Так как инстанс был создан недавно, метрик пока немного.
Вы можете нажать на иконку с тремя точками на любом графике и выбрать Enlarge, чтобы открыть метрику в развёрнутом виде.
По умолчанию включён базовый мониторинг (Basic monitoring) — данные отправляются в CloudWatch каждые 5 минут.
При необходимости можно включить детализированный мониторинг (Detailed monitoring) — метрики будут отправляться каждую минуту.

В каких случаях важно включать детализированный мониторинг?

Просмотр системного лога (System Log)
В верхнем меню нажал Actions → Monitor and troubleshoot → Get system log.
Здесь отображается вывод консоли инстанса. Это полезный инструмент для диагностики:
помогает разбирать ошибки ядра,
ошибки конфигурации сервисов,
проблемы, из-за которых инстанс может завершиться или стать недоступным до старта SSH.
Пролистайте вывод и найдите строки, показывающие установку пакетов (например, nginx из вашего User Data).
Если лог пока пуст — подождите пару минут и попробуйте снова.
нажал Cancel, чтобы выйти.
Просмотр снимка экрана инстанса (Instance Screenshot)
В меню выбрал Actions → Monitor and troubleshoot → Get instance screenshot.
Вы увидите изображение консоли вашего EC2 (как если бы к нему был подключён монитор).
Это особенно полезно, если вы не можете подключиться к инстансу по SSH: скриншот помогает понять, зависла ли ОС, есть ли kernel panic или другие ошибки.
нажал Cancel, чтобы выйти.
Задание 5. Подключение к EC2 инстансу по SSH
Открыл терминал на вашем компьютере.
Перешёл в директорию, где сохранён файл приватного ключа .pem.

cd /path/to/your/key
Установите права на ключ (для Linux/MacOS):

chmod 400 yournickname-keypair.pem
Если используете PowerShell или CMD, Убедился, что:

Файл ключа .pem находится в директории, доступной только вашему пользователю,ине имеет разрешений для других пользователей.

Настроить можно следующим образом:

Щёлкните правой кнопкой мыши на файле .pem и выбрал "Свойства".
Перешёл на вкладку "Безопасность".
Убедился, что доступ есть только у вашей учётной записи Windows.
Удалите права у «Все» (Everyone) или других пользователей.
Подключитесь к инстансу по SSH:

ssh -i yournickname-keypair.pem ec2-user@<Public-IP>
где,

-i — это параметр, указывающий на файл приватного ключа.
yournickname-keypair.pem — это имя вашего файла с приватным ключом.
ec2-user — это стандартное имя пользователя для Amazon Linux AMI.
<Public-IP> — это публичный IP-адрес инстанса EC2.
После успешного подключения вы должны увидеть приглашение командной строки, например:

[ec2-user@ip-xx-xx-xx-xx ~]$
Выполните команду для проверки статуса веб-сервера Nginx:

systemctl status nginx
Почему в AWS нельзя использовать пароль для входа по SSH?

Далее, в зависимости от вашей специализации, выбрал одно из трёх заданий (6a, 6b или 6c). Для специализации Frontend & Backend & Security подойдут задания 6a и 6b, для специализации DevOps — рекомендуется задание 6c.


Задание 6c. Запуск PHP-приложения в Docker (Для специализации DevOps)
Docker позволяет запускать приложения в контейнерах — изолированных средах, которые включают всё необходимое для работы приложения (библиотеки, зависимости, сервер). В AWS вы можете использовать Docker на EC2, а также готовые образы из Docker Hub или AWS Marketplace.

Подключитесь к вашему инстансу EC2 по SSH
Установите Docker, если он ещё не установлен.

sudo dnf -y install docker
sudo systemctl enable docker
sudo systemctl start docker
sudo usermod -aG docker ec2-user
Проверьте, что Docker работает:

docker --version
Выйдите из сессии SSH и подключитесь снова, чтобы обновить группы пользователя.

Используя docker compose, разверните PHP-приложение (созданное в рамках лабораторной работы по основам веб-разработки). Для работы приложения необходимо поднять несколько контейнеров, каждый из которых отвечает за свою часть инфраструктуры:
nginx — веб-сервер, принимающий HTTP-запросы и перенаправляющий их в PHP-обработчик.
php-fpm — сервис для интерпретации и выполнения PHP-кода.
mysql — реляционная база данных для хранения информации приложения.
adminer — лёгкий веб-интерфейс для администрирования базы данных (альтернатива phpMyAdmin).
После запуска Убедился, что:
Приложение доступно по адресу http://<Public-IP>.
Приложение корректно взаимодействует с базой данных MySQL.
Админка Adminer доступна по адресу http://<Public-IP>:8080.
Задание 7. Завершение работы и удаление ресурсов
Остановите запущенную виртуальную машину (инстанс EC2) используя AWS CLI.
Удалять виртуальную машину не обязательно, так как в следующей лабораторной работе вы будете работать с тем же инстансом.
Чем «Stop» отличается от «Terminate»
